function New-PowerADDeploy {
    param(
        [Parameter(Mandatory=$true)]
        [pscredential]$Credential,

        [Parameter(Mandatory=$true)]
        [SecureString]$SafeModePassword = 'P@ssword',

        [Parameter(Mandatory=$true)]
        [string]$ComputerName,

        [Parameter(Valuefrompipeline)]
        [string]$DomainName = 'Sprague.local',

        [Parameter()]
        [string]$DomainMode = 'WinThreshold',

        [Parameter()]
        [string]$ForestMode = 'WinThreshold'
    )

    # Get NetBIOS name
    $splitDN = $DomainName.Split(".")
    $NetBIOSName = $splitDN[0]

    Invoke-Command -ComputerName $ComputerName -Credential $Credential -ScriptBlock {

    # Define forest parameters hashtable
    $forestParams = @{
        DomainName = $using:DomainName
        DomainNetBiosName = $using:NetBIOSName
        DomainMode = $using:DomainMode
        ForestMode = $using:ForestMode
        Confirm = $false
        SafeModeAdministratorPassword = $using:SafeModePassword
        WarningAction = 'Ignore'
    }

    # Install the AD forest

       $null = Install-ADDSForest @ForestParams

    } -ArgumentList $forestParams
}
